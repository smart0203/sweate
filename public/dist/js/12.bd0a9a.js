(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{27:function(e,t,s){"use strict";var a={"":["<em>","</em>"],_:["<strong>","</strong>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function n(e){return e.replace(RegExp("^"+(e.match(/^(\t| )+/)||"")[0],"gm"),"")}function r(e){return(e+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t.a=function e(t){var s,i,o,c,l,u=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^```(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:\!\[([^\]]*?)\]\(([^\)]+?)\))|(\[)|(\](?:\(([^\)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(\-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,3})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*])/gm,m=[],f="",g=0,d={};function p(e){var t=a[e.replace(/\*/g,"_")[1]||""],s=m[m.length-1]==e;return t?t[1]?(m[s?"pop":"push"](e),t[0|s]):t[0]:e}function h(){for(var e="";m.length;)e+=p(m[m.length-1]);return e}for(t=t.replace(/^\[(.+?)\]:\s*(.+)$/gm,(function(e,t,s){return d[t.toLowerCase()]=s,""})).replace(/^\n+|\n+$/g,"");o=u.exec(t);)i=t.substring(g,o.index),g=u.lastIndex,s=o[0],i.match(/[^\\](\\\\)*\\$/)||(o[3]||o[4]?s='<pre class="code '+(o[4]?"poetry":o[2].toLowerCase())+'">'+n(r(o[3]||o[4]).replace(/^\n+|\n+$/g,""))+"</pre>":o[6]?((l=o[6]).match(/\./)&&(o[5]=o[5].replace(/^\d+/gm,"")),c=e(n(o[5].replace(/^\s*[>*+.-]/gm,""))),">"===l?l="blockquote":(l=l.match(/\./)?"ol":"ul",c=c.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),s="<"+l+">"+c+"</"+l+">"):o[8]?s='<img src="'+r(o[8])+'" alt="'+r(o[7])+'">':o[10]?(f=f.replace("<a>",'<a href="'+r(o[11]||d[i.toLowerCase()])+'">'),s=h()+"</a>"):o[9]?s="<a>":o[12]||o[14]?s="<"+(l="h"+(o[14]?o[14].length:"="===o[13][0]?1:2))+">"+e(o[12]||o[15])+"</"+l+">":o[16]?s="<code>"+r(o[16])+"</code>":(o[17]||o[1])&&(s=p(o[17]||"--"))),f+=i,f+=s;return(f+t.substring(g)+h()).trim()}},28:function(e,t,s){"use strict";(function(e){var a=s(27),n={render:function(e){return e("div",{domProps:{innerHTML:this.html}})},props:{markdown:{type:String}},computed:{html:function(){var e=this.markdown||this.slotMarkdown||"";return Object(a.a)(e)},slotMarkdown:function(){return this.$slots.default&&this.$slots.default[0].text}}};var r={install:function e(t){e.installed||(e.installed=!0,t.component("VueSnarkdown",n))}},i=null;"undefined"!=typeof window?i=window.Vue:void 0!==e&&(i=e.Vue),i&&i.use(r),t.a=n}).call(this,s(15))},39:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),r=s(3),i=s.n(r),o=s(2),c={name:"MessageItem",components:{Mark:s(28).a},props:{data:{type:Object,default:null},user:{type:Number,default:null}},computed:{chatStyle:function(){return this.user!==this.data.sender_id?"message-item__container--other":"message-item__container--self"}}},l=s(1),u=Object(l.a)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.chatStyle},[e.user!==e.data.sender_id?[s("img",{staticClass:"message-item--img",attrs:{src:e.data.sender.avatar,alt:""}}),e._v(" "),s("div",{staticClass:"ml-1 message-item__body--container"},[e.$matchMedia.xl?e._e():s("div",{staticClass:"message-item__body--name"},[e._v("\n        "+e._s(e.data.sender.full_name)+"\n      ")]),e._v(" "),s("div",{staticClass:"message-bubble__container message-bubble__container--other mt-1"},[s("Mark",{staticClass:"mark"},[e._v(e._s(e.data.message))])],1)])]:[s("div",{staticClass:"message-bubble__container message-bubble__container--self"},[s("Mark",{staticClass:"mark"},[e._v(e._s(e.data.message))])],1)]],2)}),[],!1,null,"89920af6",null).exports,m=s(27);function f(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(e){return void s(e)}o.done?t(c):Promise.resolve(c).then(a,n)}function g(e){return function(){var t=this,s=arguments;return new Promise((function(a,n){var r=e.apply(t,s);function i(e){f(r,a,n,i,o,"next",e)}function o(e){f(r,a,n,i,o,"throw",e)}i(void 0)}))}}function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var h={name:"MessagePage",layout:"backInfo",middleware:["auth"],components:{MessageItem:u},metaInfo:function(){return{title:"Message"}},data:function(){return{otherUser:{},messages:[],interval:"",firstLoad:!1}},computed:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},Object(o.b)({user:"auth/user"})),mounted:function(){this.getMessage(),this.interval=setInterval(this.getMessage,2e4)},beforeDestroy:function(){clearInterval(this.interval)},methods:{getMessage:function(){var e=this;return g(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.post("/api/user/".concat(e.$route.params.tagname,"/message")).then((function(t){var s=t.data;e.$store.dispatch("navigation/changeTitle",{title:s.user.full_name}),e.messages=s.messages,e.otherUser=s.user})).then((function(t){e.firstLoad||(e.$refs.messageScroll.scrollTop=e.$refs.messageScroll.scrollHeight,e.$refs.messageList.scrollTop=e.$refs.messageList.scrollHeight,e.firstLoad=!0)}));case 2:case"end":return t.stop()}}),t)})))()},send:function(){var e=this;return g(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.$refs.textAreaChat.value.length<1)){t.next=2;break}return t.abrupt("return",!1);case 2:i.a.post("/api/user/".concat(e.$route.params.tagname,"/message/send"),{message:Object(m.a)(e.$refs.textAreaChat.value)}).then((function(t){var s=t.data;e.$refs.textAreaChat.value="";var a="3.2rem";e.$matchMedia.xl&&(a="4.6rem"),e.$refs.textAreaChat.style.height=a,e.messages=s.messages})).then((function(t){e.$refs.messageScroll.scrollTop=e.$refs.messageScroll.scrollHeight,e.$refs.messageList.scrollTop=e.$refs.messageList.scrollHeight}));case 3:case"end":return t.stop()}}),t)})))()},autoResizeTextarea:function(e){var t=this;return g(n.a.mark((function s(){var a;return n.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e.target.value.length<1?(a="3.2rem",t.$matchMedia.xl&&(a="4.6rem"),e.target.style.height=a,t.$matchMedia.xl||(t.$refs.messageList.style.marginBottom="6.2rem")):(e.target.style.height="auto",e.target.scrollHeight>=136?e.target.style.height="13.6rem":e.target.style.height="".concat(e.target.scrollHeight/10,"rem"),t.$matchMedia.xl||(e.target.scrollHeight>=136?t.$refs.messageList.style.marginBottom="16.6rem":t.$refs.messageList.style.marginBottom="".concat(e.target.scrollHeight/10+3,"rem")),t.$refs.messageScroll.scrollTop=t.$refs.messageScroll.scrollHeight,t.$refs.messageList.scrollTop=t.$refs.messageList.scrollHeight);case 1:case"end":return s.stop()}}),s)})))()},showInfo:function(){this.$refs.showMessageInfo.openModal()},back:function(){this.$router.back()}}},v=Object(l.a)(h,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"messageScroll",staticClass:"message--container"},[e.$matchMedia.xl?s("div",{staticClass:"flex-row space-between"},[s("div",{staticClass:"flex-row"},[s("button",{staticClass:"btn--clear flex mr-1_5",on:{click:e.back}},[s("span",{staticClass:"iconify message-icon",attrs:{"data-icon":"eva:arrow-back-fill"}})]),e._v(" "),s("h2",{staticClass:"message__h1"},[e._v("\n        "+e._s(e.otherUser.full_name)+"\n      ")])]),e._v(" "),s("button",{staticClass:"btn--clear flex",on:{click:e.showInfo}},[s("span",{staticClass:"iconify message-icon",attrs:{"data-icon":"eva-info-outline"}})])]):e._e(),e._v(" "),s("div",[s("div",{ref:"messageList",staticClass:"message-item__list"},e._l(e.messages.message_bodies,(function(t){return s("MessageItem",{key:"message-"+t.id,attrs:{data:t,user:e.user.id}})})),1),e._v(" "),s("div",{staticClass:"chat-input__container"},[s("textarea",{ref:"textAreaChat",staticClass:"chat-input",attrs:{type:"text",placeholder:"Type your message here"},on:{input:e.autoResizeTextarea,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.altKey?e.send.apply(null,arguments):null}}}),e._v(" "),s("div",{staticClass:"ml-1 align-self-end flex-row"},[s("button",{staticClass:"btn--clear flex",on:{click:e.send}},[s("span",{staticClass:"iconify message-icon",attrs:{"data-icon":"carbon:send-filled"}})])])])]),e._v(" "),e.$matchMedia.xl?s("modal",{ref:"showMessageInfo",staticClass:"message__info",attrs:{type:"small"},scopedSlots:e._u([{key:"header",fn:function(){return[s("h4",{staticClass:"post__modal--h4 my-0"},[e._v("\n        How to Chat\n      ")])]},proxy:!0},{key:"body",fn:function(){return[s("div",{staticClass:"separator-short mb-1_5"}),e._v(" "),s("div",{staticClass:"message__info--body-container"},[s("p",{staticClass:"mb-2"},[e._v("\n          Chat System is based on Markdown.\n        ")]),e._v(" "),s("div",{staticClass:"flex-row"},[s("p",[e._v("Enter (new line), do enter 2 times:")]),e._v(" "),s("div",{staticClass:"message__info--pre"},[s("span",{staticClass:"iconify message__info--instruction-icon",attrs:{"data-icon":"uil:enter"}}),e._v(" "),s("span",{staticClass:"iconify message__info--instruction-icon",attrs:{"data-icon":"uil:enter"}})])]),e._v(" "),s("div",{staticClass:"flex-row"},[s("p",[s("i",[e._v("Italic")]),e._v(": ")]),e._v(" "),s("div",{staticClass:"message__info--pre"},[e._v("\n            *text* or _text_\n          ")])]),e._v(" "),s("div",{staticClass:"flex-row"},[s("p",[s("b",[e._v("Bold")]),e._v(": ")]),e._v(" "),s("div",{staticClass:"message__info--pre"},[e._v("\n            **text**\n          ")])]),e._v(" "),s("div",{staticClass:"flex-row"},[s("p",[s("b",[s("i",[e._v("Italic Bold")])]),e._v(": ")]),e._v(" "),s("div",{staticClass:"message__info--pre"},[e._v("\n            ***text***\n          ")])]),e._v(" "),s("div",{staticClass:"mt-2"},[s("div",{staticClass:"flex-row"},[s("p",[e._v("Send Chat: ")]),e._v(" "),s("div",{staticClass:"message__info--pre"},[s("p",[e._v("\n                Alt +\n                "),s("span",{staticClass:"iconify message__info--instruction-icon",attrs:{"data-icon":"uil:enter"}})])])])])])]},proxy:!0}],null,!1,1807878777)}):e._e()],1)}),[],!1,null,null,null);t.default=v.exports}}]);